*** EVALUATION ***
ANSI-C/cC++ Compiler for HC12 V-5.0.41 Build 10203, Jul 23 2010

    1:  // ----------------------------------------
    2:  // Filename:     DEM.c
    3:  // Description:
    4:  //  The Digital Energy meter library containing the cost, power and energy usage
    5:  //
    6:  // Author: Danny Sok
    7:  // Date:   14-11-2011
    8:  // Date LM: 19-11-2011
    9:  
   10:  #include "DEM.h"
   11:  
   12:  // ----------------------------------------
   13:  // DEM_Setup
   14:  // 
   15:  // Sets up the variables for the DEM
   16:  // Input:
   17:  //   none
   18:  // Output:
   19:  //   none
   20:  // Conditions:
   21:  //   none
   22:  void DEM_Setup(void)
   23:  {
*** EVALUATION ***

Function: DEM_Setup
Source  : C:\Users\evildansta\Desktop\demdanruto\Project\Sources\DEM.c
Options : -CPUHCS12 -D__NO_FLOAT__ -Env"GENPATH=C:\Users\evildansta\Desktop\demdanruto\Project;C:\Users\evildansta\Desktop\demdanruto\Project\bin;C:\Users\evildansta\Desktop\demdanruto\Project\prm;C:\Users\evildansta\Desktop\demdanruto\Project\cmd;C:\Users\evildansta\Desktop\demdanruto\Project\Sources;C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\lib;C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\src;C:\Users\evildansta\Desktop\demdanruto\Project\lib;C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\include" -Env"LIBPATH=C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\include" -EnvOBJPATH=C:\Users\evildansta\Desktop\demdanruto\Project\bin -EnvTEXTPATH=C:\Users\evildansta\Desktop\demdanruto\Project\bin -Lasm=%n.lst -Ms -ObjN=C:\Users\evildansta\Desktop\demdanruto\Project\Project_Data\Full_Chip_Simulation\ObjectCode\DEM.c.o -WmsgSd1106 -WmsgSd5703

   24:    UINT8 i;
   25:    
   26:    DEM_Average_Power.l = 0;
  0000 c7           [1]     CLRB  
  0001 87           [1]     CLRA  
  0002 7c0000       [3]     STD   DEM_Average_Power
   27:    DEM_Total_Energy.l  = 0;
  0005 7c0000       [3]     STD   DEM_Total_Energy:2
  0008 7c0000       [3]     STD   DEM_Total_Energy
   28:    DEM_Total_Cost      = 0;
  000b 7c0000       [3]     STD   DEM_Total_Cost:2
  000e 7c0000       [3]     STD   DEM_Total_Cost
   29:    DEM_VRMS.l          = 0;
  0011 7c0000       [3]     STD   DEM_VRMS
   30:    DEM_IRMS.l          = 0;
  0014 7c0000       [3]     STD   DEM_IRMS
   31:    
   32:    
   33:    for (i = 0; i < DEM_PWRSIZE; i++)
   34:    {
   35:      DEM_AvePower_Array[i] = 0;
  0017 87           [1]     CLRA  
  0018 37           [2]     PSHB  
  0019 59           [1]     LSLD  
  001a b745         [1]     TFR   D,X
  001c cd0000       [2]     LDY   #0
  001f 6de20000     [3]     STY   DEM_AvePower_Array,X
  0023 33           [3]     PULB  
  0024 52           [1]     INCB  
  0025 c110         [1]     CMPB  #16
  0027 25ee         [3/1]   BCS   *-16 ;abs = 0017
   36:    }
   37:  }
  0029 3d           [5]     RTS   
   38:  
   39:  // ----------------------------------------
   40:  // DEM_SetTarrif
   41:  // 
   42:  // Updates the tarrif variable to the correct one
   43:  // based on the time
   44:  // Input:
   45:  //   none
   46:  // Output:
   47:  //   none
   48:  // Conditions:
   49:  //   none
   50:  void DEM_SetTarrif(void)
   51:  {
*** EVALUATION ***

Function: DEM_SetTarrif
Source  : C:\Users\evildansta\Desktop\demdanruto\Project\Sources\DEM.c
Options : -CPUHCS12 -D__NO_FLOAT__ -Env"GENPATH=C:\Users\evildansta\Desktop\demdanruto\Project;C:\Users\evildansta\Desktop\demdanruto\Project\bin;C:\Users\evildansta\Desktop\demdanruto\Project\prm;C:\Users\evildansta\Desktop\demdanruto\Project\cmd;C:\Users\evildansta\Desktop\demdanruto\Project\Sources;C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\lib;C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\src;C:\Users\evildansta\Desktop\demdanruto\Project\lib;C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\include" -Env"LIBPATH=C:\Program Files\Freescale\CWS12v5.1\lib\HC12c\include" -EnvOBJPATH=C:\Users\evildansta\Desktop\demdanruto\Project\bin -EnvTEXTPATH=C:\Users\evildansta\Desktop\demdanruto\Project\bin -Lasm=%n.lst -Ms -ObjN=C:\Users\evildansta\Desktop\demdanruto\Project\Project_Data\Full_Chip_Simulation\ObjectCode\DEM.c.o -WmsgSd1106 -WmsgSd5703

   52:    /*
   53:    Peak 14-20
   54:    Shoulder 7-14
   55:    Off Peak every
   56:    */
   57:    
   58:    // Time of Use
   59:    if (DEM_Average_Power.l > 0 && sTarrifMode == 1)
  0000 fc0000       [3]     LDD   DEM_Average_Power
  0003 2f27         [3/1]   BLE   *+41 ;abs = 002c
  0005 fc0460       [3]     LDD   1120
  0008 042421       [3]     DBNE  D,*+36 ;abs = 002c
   60:    {
   61:      
   62:      if (Clock_Hours >= 14 && Clock_Hours <= 20)
  000b f60000       [3]     LDAB  Clock_Hours
  000e c00e         [1]     SUBB  #14
  0010 c106         [1]     CMPB  #6
  0012 2205         [3/1]   BHI   *+7 ;abs = 0019
   63:        DEM_Tarrif = sT1Peak;  
  0014 fc0450       [3]     LDD   1104
  0017 2023         [3]     BRA   *+37 ;abs = 003c
   64:      else if (Clock_Hours >= 7 && Clock_Hours < 14)
  0019 f60000       [3]     LDAB  Clock_Hours
  001c c007         [1]     SUBB  #7
  001e c106         [1]     CMPB  #6
  0020 2205         [3/1]   BHI   *+7 ;abs = 0027
   65:        DEM_Tarrif = sT1Shoulder;
  0022 fc0452       [3]     LDD   1106
  0025 2015         [3]     BRA   *+23 ;abs = 003c
   66:      else
   67:        DEM_Tarrif = sT1OffPeak;
  0027 fc0454       [3]     LDD   1108
  002a 2010         [3]     BRA   *+18 ;abs = 003c
   68:    }
   69:    else if (sTarrifMode == 2)
  002c fc0460       [3]     LDD   1120
  002f 8c0002       [2]     CPD   #2
  0032 2605         [3/1]   BNE   *+7 ;abs = 0039
   70:      DEM_Tarrif = sT2NonTOU;
  0034 fc0456       [3]     LDD   1110
  0037 2003         [3]     BRA   *+5 ;abs = 003c
   71:    
   72:    else
   73:      DEM_Tarrif = sT3NonTOU;
  0039 fc0458       [3]     LDD   1112
  003c 7c0000       [3]     STD   DEM_Tarrif
   74:  }
  003f 3d           [5]     RTS   
